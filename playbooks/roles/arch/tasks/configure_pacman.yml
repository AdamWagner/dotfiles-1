---
# Add multilib and infinality (fonts) repositories

- name: "Add multilib"
  lineinfile:
    dest: "/etc/pacman.conf"
    state: "present"
    line: "[multilib]"
    regexp: "^\\[multilib\\]"
    insertafter: "^#\\[multilib\\]"

- name: "Add multilib (cont)"
  lineinfile:
    dest: "/etc/pacman.conf"
    state: "present"
    line: "Include = /etc/pacman.d/mirrorlist"
    insertafter: "^\\[multilib\\]"
    regexp: "Include = /etc/pacman.d/mirrorlist"

- name: "Add infinality-bundle key"
  shell: "pacman-key -r 962DDE58 && pacman-key --lsign-key 962DDE58"
  changed_when: false

- name: "Add infinality-bundle" # https://wiki.archlinux.org/index.php/Unofficial_user_repositories#infinality-bundle
  lineinfile:
    dest: "/etc/pacman.conf"
    state: "present"
    line: "[infinality-bundle]"

- name: "Add infinality-bundle (cont)"
  lineinfile:
    dest: "/etc/pacman.conf"
    state: "present"
    line: "Server = http://bohoomil.com/repo/$arch"
    insertafter: "^\\[infinality\\-bundle\\]"

- name: "Add infinality-bundle-fonts" # https://wiki.archlinux.org/index.php/Unofficial_user_repositories#infinality-bundle
  lineinfile:
    dest: "/etc/pacman.conf"
    state: "present"
    line: "[infinality-bundle-fonts]"

- name: "Add infinality-bundle-fonts (cont)"
  lineinfile:
    dest: "/etc/pacman.conf"
    state: "present"
    line: "Server = http://bohoomil.com/repo/fonts"
    insertafter: "^\\[infinality\\-bundle\\-fonts\\]"